<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<title>ìœ ë…¸ ë¡œê·¸ë¼ì´í¬ RPG</title>
<style>
  body {
    background: #111;
    color: #eee;
    font-family: monospace;
    padding: 10px;
    max-width: 600px;
    margin: auto;
  }
  #status {
    border: 1px solid #0f0;
    padding: 10px;
    margin-bottom: 10px;
  }
  #log {
    background: #222;
    height: 200px;
    overflow-y: auto;
    padding: 10px;
    margin-bottom: 10px;
    white-space: pre-line;
  }
  #choices button {
    margin: 5px;
    padding: 10px;
    background: #0f0;
    border: none;
    color: #000;
    font-weight: bold;
    cursor: pointer;
  }
  #choices button:hover {
    background: #afa;
  }
</style>
</head>
<body>

<h1>ìœ ë…¸ ë¡œê·¸ë¼ì´í¬ RPG</h1>

<div id="status">
  <div>HP: <span id="hp">30</span></div>
  <div>ê³µê²©ë ¥: <span id="attack">5</span></div>
  <div>ë§µ ìœ„ì¹˜: <span id="position">0</span></div>
</div>

<div id="log"></div>

<div id="choices"></div>

<script>
(() => {
  // í”Œë ˆì´ì–´ ìƒíƒœ
  const player = {
    hp: 30,
    attack: 5,
    position: 0,
  };

  // ëª¬ìŠ¤í„° ì˜ˆì‹œ
  class Monster {
    constructor(name, hp, attack) {
      this.name = name;
      this.hp = hp;
      this.attack = attack;
    }
  }

  // ëœë¤ ëª¬ìŠ¤í„° ìƒì„±
  function spawnMonster() {
    const monsters = [
      new Monster('ìŠ¬ë¼ì„', 10, 2),
      new Monster('ê³ ë¸”ë¦°', 15, 3),
      new Monster('ëŠ‘ëŒ€', 20, 4)
    ];
    return monsters[Math.floor(Math.random() * monsters.length)];
  }

  let currentMonster = null;

  // DOM ìš”ì†Œë“¤
  const hpEl = document.getElementById('hp');
  const attackEl = document.getElementById('attack');
  const positionEl = document.getElementById('position');
  const logEl = document.getElementById('log');
  const choicesEl = document.getElementById('choices');

  // ë¡œê·¸ ì¶”ê°€ í•¨ìˆ˜
  function log(text) {
    logEl.textContent += text + '\n';
    logEl.scrollTop = logEl.scrollHeight;
  }

  // ìƒíƒœ ì—…ë°ì´íŠ¸
  function updateStatus() {
    hpEl.textContent = player.hp;
    attackEl.textContent = player.attack;
    positionEl.textContent = player.position;
  }

  // ì „íˆ¬ ì‹œì‘
  function startBattle() {
    log(`âš”ï¸ ì „íˆ¬ ì‹œì‘! ${currentMonster.name}ì´(ê°€) ë‚˜íƒ€ë‚¬ë‹¤!`);
    showBattleChoices();
  }

  // ì „íˆ¬ ì„ íƒì§€ ë³´ì—¬ì£¼ê¸°
  function showBattleChoices() {
    choicesEl.innerHTML = '';
    const attackBtn = document.createElement('button');
    attackBtn.textContent = 'ê³µê²©í•˜ê¸°';
    attackBtn.onclick = () => playerAttack();
    choicesEl.appendChild(attackBtn);

    const runBtn = document.createElement('button');
    runBtn.textContent = 'ë„ë§ê°€ê¸°';
    runBtn.onclick = () => {
      log('ë„ë§ì³¤ë‹¤!');
      currentMonster = null;
      showMoveChoices();
    };
    choicesEl.appendChild(runBtn);
  }

  // í”Œë ˆì´ì–´ ê³µê²©
  function playerAttack() {
    currentMonster.hp -= player.attack;
    log(`ë‹¹ì‹ ì´ ${currentMonster.name}ì—ê²Œ ${player.attack}ì˜ í”¼í•´ë¥¼ ì…í˜”ë‹¤! (ë‚¨ì€ HP: ${currentMonster.hp})`);
    if (currentMonster.hp <= 0) {
      log(`${currentMonster.name}ì„(ë¥¼) ì“°ëŸ¬ëœ¨ë ¸ë‹¤!`);
      currentMonster = null;
      showMoveChoices();
    } else {
      monsterAttack();
    }
  }

  // ëª¬ìŠ¤í„° ê³µê²©
  function monsterAttack() {
    player.hp -= currentMonster.attack;
    log(`${currentMonster.name}ì´(ê°€) ë‹¹ì‹ ì„ ê³µê²©í–ˆë‹¤! ${currentMonster.attack}ì˜ í”¼í•´! (ë‚¨ì€ HP: ${player.hp})`);
    updateStatus();
    if (player.hp <= 0) {
      gameOver();
    } else {
      showBattleChoices();
    }
  }

  // ì´ë™ ì„ íƒì§€ ë³´ì—¬ì£¼ê¸°
  function showMoveChoices() {
    choicesEl.innerHTML = '';
    const moveBtn = document.createElement('button');
    moveBtn.textContent = 'í•œ ì¹¸ ì´ë™í•˜ê¸°';
    moveBtn.onclick = () => {
      player.position++;
      updateStatus();
      // ì´ë™ ì‹œ ëœë¤ ëª¬ìŠ¤í„° ì¶œí˜„ í™•ë¥  50%
      if (Math.random() < 0.5) {
        currentMonster = spawnMonster();
        startBattle();
      } else {
        log(`ë§µ ìœ„ì¹˜ê°€ ${player.position}ìœ¼ë¡œ ì´ë™í–ˆë‹¤. ì£¼ë³€ì´ ì¡°ìš©í•˜ë‹¤...`);
        showMoveChoices();
      }
    };
    choicesEl.appendChild(moveBtn);
  }

  // ê²Œì„ ì˜¤ë²„ ì²˜ë¦¬
  function gameOver() {
    log('ğŸ’€ ë‹¹ì‹ ì€ ì“°ëŸ¬ì¡Œë‹¤... ê²Œì„ ì˜¤ë²„!');
    choicesEl.innerHTML = '';
    const restartBtn = document.createElement('button');
    restartBtn.textContent = 'ë‹¤ì‹œ ì‹œì‘';
    restartBtn.onclick = () => location.reload();
    choicesEl.appendChild(restartBtn);
  }

  // ê²Œì„ ì‹œì‘
  updateStatus();
  log('ê²Œì„ì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤! ì´ë™ ë²„íŠ¼ì„ ëˆŒëŸ¬ ì‹œì‘í•˜ì„¸ìš”.');
  showMoveChoices();

})();
</script>

</body>
</html>
